"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var element_registry_1 = require("nativescript-angular/element-registry");
var firebase = require("nativescript-plugin-firebase");
var barcodescanning_1 = require("nativescript-plugin-firebase/mlkit/barcodescanning");
var image_source_1 = require("tns-core-modules/image-source");
var file_system_1 = require("tns-core-modules/file-system");
var FacedetectionComponent = /** @class */ (function () {
    function FacedetectionComponent() {
        // registerElement("MLKitTextRecognition", () => require("nativescript-plugin-firebase/mlkit/textrecognition").MLKitTextRecognition);
        // registerElement("MLKitFaceDetection", () => require("nativescript-plugin-firebase/mlkit/facedetection").MLKitFaceDetection);
        // registerElement("MLKitBarcodeScanner", () => require("nativescript-plugin-firebase/mlkit/barcodescanning").MLKitBarcodeScanner);
        element_registry_1.registerElement("MLKitImageLabeling", function () { return require("nativescript-plugin-firebase/mlkit/imagelabeling").MLKitImageLabeling; });
    }
    FacedetectionComponent.prototype.ngOnInit = function () { };
    FacedetectionComponent.prototype.onImageLabelingResult = function (scanResult) {
        var value = scanResult.value;
        this.labels = value.labels;
        this.labels.forEach(function (label) {
            console.log(label);
        });
    };
    //------------------------ firebase ml kit test ------------------
    FacedetectionComponent.prototype.textRecognition = function () {
        var folder = file_system_1.knownFolders.currentApp();
        var folderPath = file_system_1.path.join(folder.path, "./images/Wege_der_parlamentarischen_Demokratie.jpg");
        var imageSource = image_source_1.fromFile(folderPath);
        console.log(imageSource);
        firebase.mlkit.textrecognition.recognizeTextOnDevice({
            image: imageSource // a NativeScript Image or ImageSource, see the demo for examples
        }).then(function (result) {
            console.log(result.text ? result.text : "");
        }).catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent.prototype.faceDetection = function () {
        var folder = file_system_1.knownFolders.currentApp();
        var folderPath = file_system_1.path.join(folder.path, "./images/sansoo.jpg");
        var imageSource = image_source_1.fromFile(folderPath);
        firebase.mlkit.facedetection.detectFacesOnDevice({
            image: imageSource,
            detectionMode: "accurate",
            enableFaceTracking: true,
            minimumFaceSize: 0.25 // default 0.1 (which means the face must be at least 10% of the image)
        })
            .then(function (result) { return console.log(JSON.stringify(result.faces)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent.prototype.barcodeScanning = function () {
        var folder = file_system_1.knownFolders.currentApp();
        var folderPath = file_system_1.path.join(folder.path, "./images/qrcode.png");
        var imageSource = image_source_1.fromFile(folderPath);
        firebase.mlkit.barcodescanning.scanBarcodesOnDevice({
            image: imageSource,
            formats: [barcodescanning_1.BarcodeFormat.QR_CODE, barcodescanning_1.BarcodeFormat.CODABAR] // limit recognition to certain formats (faster), or leave out entirely for all formats (default)
        })
            .then(function (result) { return console.log(JSON.stringify(result.barcodes)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
        var folderPath2 = file_system_1.path.join(folder.path, "./images/EAN-Obst.jpg");
        var imageSource2 = image_source_1.fromFile(folderPath2);
        firebase.mlkit.barcodescanning.scanBarcodesOnDevice({
            image: imageSource2,
            formats: [barcodescanning_1.BarcodeFormat.EAN_13] // limit recognition to certain formats (faster), or leave out entirely for all formats (default)
        })
            .then(function (result) { return console.log(JSON.stringify(result.barcodes)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent.prototype.imageLabeling = function () {
        var folder = file_system_1.knownFolders.currentApp();
        var folderPath = file_system_1.path.join(folder.path, "./images/1024px-Valais_Cup_2013_-_OM-FC_Porto_13-07-2013_-_Brice_Samba_en_extension.jpg");
        var imageSource = image_source_1.fromFile(folderPath);
        firebase.mlkit.imagelabeling.labelImageOnDevice({
            image: imageSource,
            confidenceThreshold: 0.6 // this will only return labels with at least 0.6 (60%) confidence. Default 0.5.
        })
            .then(function (result) { return console.log(JSON.stringify(result.labels)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
        firebase.mlkit.imagelabeling.labelImageCloud({
            image: imageSource,
            modelType: "stable",
            maxResults: 5 // default 10
        })
            .then(function (result) { return console.log(JSON.stringify(result.labels)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent.prototype.landmarkRecognition = function () {
        var folder = file_system_1.knownFolders.currentApp();
        var folderPath = file_system_1.path.join(folder.path, "./images/680px-Bruegge_View_from_Rozenhoedkaai.jpg");
        var imageSource = image_source_1.fromFile(folderPath);
        firebase.mlkit.landmarkrecognition.recognizeLandmarksCloud({
            image: imageSource,
            modelType: "latest",
            maxResults: 8 // default 10
        })
            .then(function (result) { return console.log(JSON.stringify(result.landmarks)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent.prototype.customModel = function () {
        firebase.mlkit.custommodel.useCustomModel({
            // image: imageSource, // a NativeScript Image or ImageSource, see the demo for examples
            maxResults: 10,
            localModelFile: "~/custommodel/inception/inception_v3_quant.tflite",
            labelsFile: "~/custommodel/inception/inception_labels.txt",
            modelInput: [{
                    shape: [1, 299, 299, 3],
                    type: "QUANT" // for now, must be "QUANT" (and you should use a 'quantized' model (not 'float'))
                }]
        })
            .then(function (result) { return console.log(JSON.stringify(result.result)); })
            .catch(function (errorMessage) { return console.log("ML Kit error: " + errorMessage); });
    };
    FacedetectionComponent = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'Facedetection',
            templateUrl: './facedetection.component.html',
            styleUrls: ['./facedetection.component.scss']
        }),
        __metadata("design:paramtypes", [])
    ], FacedetectionComponent);
    return FacedetectionComponent;
}());
exports.FacedetectionComponent = FacedetectionComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFjZWRldGVjdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJmYWNlZGV0ZWN0aW9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUFrRDtBQUNsRCwwRUFBd0U7QUFFeEUsdURBQTBEO0FBRzFELHNGQUFvSDtBQUtwSCw4REFBc0U7QUFDdEUsNERBQTBFO0FBUTFFO0lBRUk7UUFDSSxxSUFBcUk7UUFDckksK0hBQStIO1FBQy9ILG1JQUFtSTtRQUNuSSxrQ0FBZSxDQUFDLG9CQUFvQixFQUFFLGNBQU0sT0FBQSxPQUFPLENBQUMsa0RBQWtELENBQUMsQ0FBQyxrQkFBa0IsRUFBOUUsQ0FBOEUsQ0FBQyxDQUFDO0lBQ2hJLENBQUM7SUFFRCx5Q0FBUSxHQUFSLGNBQWEsQ0FBQztJQU1kLHNEQUFxQixHQUFyQixVQUFzQixVQUFlO1FBQ2pDLElBQU0sS0FBSyxHQUFxQyxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztRQUMzQixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFBLEtBQUs7WUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFLRCxrRUFBa0U7SUFDbEUsZ0RBQWUsR0FBZjtRQUNJLElBQU0sTUFBTSxHQUFvQiwwQkFBWSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzFELElBQU0sVUFBVSxHQUFXLGtCQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsb0RBQW9ELENBQUMsQ0FBQztRQUN4RyxJQUFNLFdBQVcsR0FBOEIsdUJBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUVwRSxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3pCLFFBQVEsQ0FBQyxLQUFLLENBQUMsZUFBZSxD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O29CQUN2QixJQUFJLEVBQUUsT0FBTyxDQUFDLGtGQUFrRjtpQkFDbkcsQ0FBQztTQUNMLENBQUM7YUFDRCxJQUFJLENBQUMsVUFBQyxNQUE4QixJQUFLLE9BQUEsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUExQyxDQUEwQyxDQUFDO2FBQ3BGLEtBQUssQ0FBQyxVQUFBLFlBQVksSUFBSSxPQUFBLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEdBQUcsWUFBWSxDQUFDLEVBQTVDLENBQTRDLENBQUMsQ0FBQztJQUM3RSxDQUFDO0lBdEhRLHNCQUFzQjtRQU5sQyxnQkFBUyxDQUFDO1lBQ1AsUUFBUSxFQUFFLE1BQU0sQ0FBQyxFQUFFO1lBQ25CLFFBQVEsRUFBRSxlQUFlO1lBQ3pCLFdBQVcsRUFBRSxnQ0FBZ0M7WUFDN0MsU0FBUyxFQUFFLENBQUMsZ0NBQWdDLENBQUM7U0FDaEQsQ0FBQzs7T0FDVyxzQkFBc0IsQ0F1SGxDO0lBQUQsNkJBQUM7Q0FBQSxBQXZIRCxJQXVIQztBQXZIWSx3REFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyByZWdpc3RlckVsZW1lbnQgfSBmcm9tIFwibmF0aXZlc2NyaXB0LWFuZ3VsYXIvZWxlbWVudC1yZWdpc3RyeVwiO1xyXG5cclxuaW1wb3J0IGZpcmViYXNlID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2VcIik7XHJcbmltcG9ydCB7IE1MS2l0UmVjb2duaXplVGV4dFJlc3VsdCwgTUxLaXRSZWNvZ25pemVUZXh0UmVzdWx0QmxvY2sgfSBmcm9tIFwibmF0aXZlc2NyaXB0LXBsdWdpbi1maXJlYmFzZS9tbGtpdC90ZXh0cmVjb2duaXRpb25cIjtcclxuaW1wb3J0IHsgTUxLaXREZXRlY3RGYWNlc09uRGV2aWNlUmVzdWx0LCBNTEtpdERldGVjdEZhY2VzUmVzdWx0RmFjZSB9IGZyb20gXCJuYXRpdmVzY3JpcHQtcGx1Z2luLWZpcmViYXNlL21sa2l0L2ZhY2VkZXRlY3Rpb25cIjtcclxuaW1wb3J0IHsgQmFyY29kZUZvcm1hdCwgTUxLaXRTY2FuQmFyY29kZXNPbkRldmljZVJlc3VsdCB9IGZyb20gXCJuYXRpdmVzY3JpcHQtcGx1Z2luLWZpcmViYXNlL21sa2l0L2JhcmNvZGVzY2FubmluZ1wiO1xyXG5pbXBvcnQgeyBNTEtpdEltYWdlTGFiZWxpbmdPbkRldmljZVJlc3VsdCB9IGZyb20gXCJuYXRpdmVzY3JpcHQtcGx1Z2luLWZpcmViYXNlL21sa2l0L2ltYWdlbGFiZWxpbmdcIjtcclxuaW1wb3J0IHsgTUxLaXRJbWFnZUxhYmVsaW5nQ2xvdWRSZXN1bHQgfSBmcm9tIFwibmF0aXZlc2NyaXB0LXBsdWdpbi1maXJlYmFzZS9tbGtpdC9pbWFnZWxhYmVsaW5nXCI7XHJcbmltcG9ydCB7IE1MS2l0TGFuZG1hcmtSZWNvZ25pdGlvbkNsb3VkUmVzdWx0IH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2UvbWxraXQvbGFuZG1hcmtyZWNvZ25pdGlvblwiO1xyXG5pbXBvcnQgeyBNTEtpdEN1c3RvbU1vZGVsUmVzdWx0IH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2UvbWxraXQvY3VzdG9tbW9kZWxcIjtcclxuaW1wb3J0IHsgSW1hZ2VTb3VyY2UsIGZyb21GaWxlIH0gZnJvbSBcInRucy1jb3JlLW1vZHVsZXMvaW1hZ2Utc291cmNlXCI7XHJcbmltcG9ydCB7IEZvbGRlciwgcGF0aCwga25vd25Gb2xkZXJzIH0gZnJvbSBcInRucy1jb3JlLW1vZHVsZXMvZmlsZS1zeXN0ZW1cIjtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcclxuICAgIHNlbGVjdG9yOiAnRmFjZWRldGVjdGlvbicsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZmFjZWRldGVjdGlvbi5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9mYWNlZGV0ZWN0aW9uLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEZhY2VkZXRlY3Rpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgLy8gcmVnaXN0ZXJFbGVtZW50KFwiTUxLaXRUZXh0UmVjb2duaXRpb25cIiwgKCkgPT4gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2UvbWxraXQvdGV4dHJlY29nbml0aW9uXCIpLk1MS2l0VGV4dFJlY29nbml0aW9uKTtcclxuICAgICAgICAvLyByZWdpc3RlckVsZW1lbnQoXCJNTEtpdEZhY2VEZXRlY3Rpb25cIiwgKCkgPT4gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2UvbWxraXQvZmFjZWRldGVjdGlvblwiKS5NTEtpdEZhY2VEZXRlY3Rpb24pO1xyXG4gICAgICAgIC8vIHJlZ2lzdGVyRWxlbWVudChcIk1MS2l0QmFyY29kZVNjYW5uZXJcIiwgKCkgPT4gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2UvbWxraXQvYmFyY29kZXNjYW5uaW5nXCIpLk1MS2l0QmFyY29kZVNjYW5uZXIpO1xyXG4gICAgICAgIHJlZ2lzdGVyRWxlbWVudChcIk1MS2l0SW1hZ2VMYWJlbGluZ1wiLCAoKSA9PiByZXF1aXJlKFwibmF0aXZlc2NyaXB0LXBsdWdpbi1maXJlYmFzZS9tbGtpdC9pbWFnZWxhYmVsaW5nXCIpLk1MS2l0SW1hZ2VMYWJlbGluZyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIG5nT25Jbml0KCkgeyB9XHJcblxyXG4gICAgbGFiZWxzOiBBcnJheTx7XHJcbiAgICAgICAgdGV4dDogc3RyaW5nO1xyXG4gICAgICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcclxuICAgIH0+O1xyXG4gICAgb25JbWFnZUxhYmVsaW5nUmVzdWx0KHNjYW5SZXN1bHQ6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlOiBNTEtpdEltYWdlTGFiZWxpbmdPbkRldmljZVJlc3VsdCA9IHNjYW5SZXN1bHQudmFsdWU7XHJcbiAgICAgICAgdGhpcy5sYWJlbHMgPSB2YWx1ZS5sYWJlbHM7XHJcbiAgICAgICAgdGhpcy5sYWJlbHMuZm9yRWFjaChsYWJlbCA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cobGFiZWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGZpcmViYXNlIG1sIGtpdCB0ZXN0IC0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgdGV4dFJlY29nbml0aW9uKCl7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyOiBGb2xkZXIgPSA8Rm9sZGVyPiBrbm93bkZvbGRlcnMuY3VycmVudEFwcCgpO1xyXG4gICAgICAgIGNvbnN0IGZvbGRlclBhdGg6IHN0cmluZyA9IHBhdGguam9pbihmb2xkZXIucGF0aCwgXCIuL2ltYWdlcy9XZWdlX2Rlcl9wYXJsYW1lbnRhcmlzY2hlbl9EZW1va3JhdGllLmpwZ1wiKTtcclxuICAgICAgICBjb25zdCBpbWFnZVNvdXJjZTogSW1hZ2VTb3VyY2UgPSA8SW1hZ2VTb3VyY2U+IGZyb21GaWxlKGZvbGRlclBhdGgpO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhpbWFnZVNvdXJjZSk7XHJcbiAgICAgICAgZmlyZWJhc2UubWxraXQudGV4dHJlY29nbml0aW9uLnJlY29nbml6ZVRleHRPbkRldmljZSh7XHJcbiAgICAgICAgICAgIGltYWdlOiBpbWFnZVNvdXJjZSAvLyBhIE5hdGl2ZVNjcmlwdCBJbWFnZSBvciBJbWFnZVNvdXJjZSwgc2VlIHRoZSBkZW1vIGZvciBleGFtcGxlc1xyXG4gICAgICAgIH0pLnRoZW4oKHJlc3VsdDogTUxLaXRSZWNvZ25pemVUZXh0UmVzdWx0KSA9PiB7IC8vIGp1c3QgbG9vayBhdCB0aGlzIHR5cGUgdG8gc2VlIHdoYXQgZWxzZSBpcyByZXR1cm5lZFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQudGV4dCA/IHJlc3VsdC50ZXh0IDogXCJcIik7XHJcbiAgICAgICAgfSkuY2F0Y2goZXJyb3JNZXNzYWdlID0+IGNvbnNvbGUubG9nKFwiTUwgS2l0IGVycm9yOiBcIiArIGVycm9yTWVzc2FnZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZhY2VEZXRlY3Rpb24oKXtcclxuICAgICAgICBjb25zdCBmb2xkZXI6IEZvbGRlciA9IDxGb2xkZXI+IGtub3duRm9sZGVycy5jdXJyZW50QXBwKCk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aDogc3RyaW5nID0gcGF0aC5qb2luKGZvbGRlci5wYXRoLCBcIi4vaW1hZ2VzL3NhbnNvby5qcGdcIik7XHJcbiAgICAgICAgY29uc3QgaW1hZ2VTb3VyY2U6IEltYWdlU291cmNlID0gPEltYWdlU291cmNlPiBmcm9tRmlsZShmb2xkZXJQYXRoKTtcclxuICAgICAgICBmaXJlYmFzZS5tbGtpdC5mYWNlZGV0ZWN0aW9uLmRldGVjdEZhY2VzT25EZXZpY2Uoe1xyXG4gICAgICAgICAgICBpbWFnZTogaW1hZ2VTb3VyY2UsIC8vIGEgTmF0aXZlU2NyaXB0IEltYWdlIG9yIEltYWdlU291cmNlLCBzZWUgdGhlIGRlbW8gZm9yIGV4YW1wbGVzXHJcbiAgICAgICAgICAgIGRldGVjdGlvbk1vZGU6IFwiYWNjdXJhdGVcIiwgLy8gZGVmYXVsdCBcImZhc3RcIlxyXG4gICAgICAgICAgICBlbmFibGVGYWNlVHJhY2tpbmc6IHRydWUsIC8vIGRlZmF1bHQgZmFsc2VcclxuICAgICAgICAgICAgbWluaW11bUZhY2VTaXplOiAwLjI1IC8vIGRlZmF1bHQgMC4xICh3aGljaCBtZWFucyB0aGUgZmFjZSBtdXN0IGJlIGF0IGxlYXN0IDEwJSBvZiB0aGUgaW1hZ2UpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigocmVzdWx0OiBNTEtpdERldGVjdEZhY2VzT25EZXZpY2VSZXN1bHQpID0+IGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3VsdC5mYWNlcykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvck1lc3NhZ2UgPT4gY29uc29sZS5sb2coXCJNTCBLaXQgZXJyb3I6IFwiICsgZXJyb3JNZXNzYWdlKSk7XHJcbiAgICB9XHJcbiAgICBiYXJjb2RlU2Nhbm5pbmcoKXtcclxuICAgICAgICBjb25zdCBmb2xkZXI6IEZvbGRlciA9IDxGb2xkZXI+IGtub3duRm9sZGVycy5jdXJyZW50QXBwKCk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aDogc3RyaW5nID0gcGF0aC5qb2luKGZvbGRlci5wYXRoLCBcIi4vaW1hZ2VzL3FyY29kZS5wbmdcIik7XHJcbiAgICAgICAgY29uc3QgaW1hZ2VTb3VyY2U6IEltYWdlU291cmNlID0gPEltYWdlU291cmNlPiBmcm9tRmlsZShmb2xkZXJQYXRoKTtcclxuICAgICAgICBmaXJlYmFzZS5tbGtpdC5iYXJjb2Rlc2Nhbm5pbmcuc2NhbkJhcmNvZGVzT25EZXZpY2Uoe1xyXG4gICAgICAgICAgICBpbWFnZTogaW1hZ2VTb3VyY2UsXHJcbiAgICAgICAgICAgIGZvcm1hdHM6IFtCYXJjb2RlRm9ybWF0LlFSX0NPREUsIEJhcmNvZGVGb3JtYXQuQ09EQUJBUl0gLy8gbGltaXQgcmVjb2duaXRpb24gdG8gY2VydGFpbiBmb3JtYXRzIChmYXN0ZXIpLCBvciBsZWF2ZSBvdXQgZW50aXJlbHkgZm9yIGFsbCBmb3JtYXRzIChkZWZhdWx0KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlc3VsdDogTUxLaXRTY2FuQmFyY29kZXNPbkRldmljZVJlc3VsdCkgPT4gY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzdWx0LmJhcmNvZGVzKSkpXHJcbiAgICAgICAgLmNhdGNoKGVycm9yTWVzc2FnZSA9PiBjb25zb2xlLmxvZyhcIk1MIEtpdCBlcnJvcjogXCIgKyBlcnJvck1lc3NhZ2UpKTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aDI6IHN0cmluZyA9IHBhdGguam9pbihmb2xkZXIucGF0aCwgXCIuL2ltYWdlcy9FQU4tT2JzdC5qcGdcIik7XHJcbiAgICAgICAgY29uc3QgaW1hZ2VTb3VyY2UyOiBJbWFnZVNvdXJjZSA9IDxJbWFnZVNvdXJjZT4gZnJvbUZpbGUoZm9sZGVyUGF0aDIpO1xyXG4gICAgICAgIGZpcmViYXNlLm1sa2l0LmJhcmNvZGVzY2FubmluZy5zY2FuQmFyY29kZXNPbkRldmljZSh7XHJcbiAgICAgICAgICAgIGltYWdlOiBpbWFnZVNvdXJjZTIsXHJcbiAgICAgICAgICAgIGZvcm1hdHM6IFtCYXJjb2RlRm9ybWF0LkVBTl8xM10gLy8gbGltaXQgcmVjb2duaXRpb24gdG8gY2VydGFpbiBmb3JtYXRzIChmYXN0ZXIpLCBvciBsZWF2ZSBvdXQgZW50aXJlbHkgZm9yIGFsbCBmb3JtYXRzIChkZWZhdWx0KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlc3VsdDogTUxLaXRTY2FuQmFyY29kZXNPbkRldmljZVJlc3VsdCkgPT4gY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzdWx0LmJhcmNvZGVzKSkpXHJcbiAgICAgICAgLmNhdGNoKGVycm9yTWVzc2FnZSA9PiBjb25zb2xlLmxvZyhcIk1MIEtpdCBlcnJvcjogXCIgKyBlcnJvck1lc3NhZ2UpKTtcclxuICAgIH1cclxuICAgIGltYWdlTGFiZWxpbmcoKXtcclxuICAgICAgICBjb25zdCBmb2xkZXI6IEZvbGRlciA9IDxGb2xkZXI+IGtub3duRm9sZGVycy5jdXJyZW50QXBwKCk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aDogc3RyaW5nID0gcGF0aC5qb2luKGZvbGRlci5wYXRoLCBcIi4vaW1hZ2VzLzEwMjRweC1WYWxhaXNfQ3VwXzIwMTNfLV9PTS1GQ19Qb3J0b18xMy0wNy0yMDEzXy1fQnJpY2VfU2FtYmFfZW5fZXh0ZW5zaW9uLmpwZ1wiKTtcclxuICAgICAgICBjb25zdCBpbWFnZVNvdXJjZTogSW1hZ2VTb3VyY2UgPSA8SW1hZ2VTb3VyY2U+IGZyb21GaWxlKGZvbGRlclBhdGgpO1xyXG5cclxuICAgICAgICBmaXJlYmFzZS5tbGtpdC5pbWFnZWxhYmVsaW5nLmxhYmVsSW1hZ2VPbkRldmljZSh7XHJcbiAgICAgICAgICAgIGltYWdlOiBpbWFnZVNvdXJjZSxcclxuICAgICAgICAgICAgY29uZmlkZW5jZVRocmVzaG9sZDogMC42IC8vIHRoaXMgd2lsbCBvbmx5IHJldHVybiBsYWJlbHMgd2l0aCBhdCBsZWFzdCAwLjYgKDYwJSkgY29uZmlkZW5jZS4gRGVmYXVsdCAwLjUuXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigocmVzdWx0OiBNTEtpdEltYWdlTGFiZWxpbmdPbkRldmljZVJlc3VsdCkgPT4gY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzdWx0LmxhYmVscykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvck1lc3NhZ2UgPT4gY29uc29sZS5sb2coXCJNTCBLaXQgZXJyb3I6IFwiICsgZXJyb3JNZXNzYWdlKSk7XHJcblxyXG4gICAgICAgIGZpcmViYXNlLm1sa2l0LmltYWdlbGFiZWxpbmcubGFiZWxJbWFnZUNsb3VkKHtcclxuICAgICAgICAgICAgaW1hZ2U6IGltYWdlU291cmNlLFxyXG4gICAgICAgICAgICBtb2RlbFR5cGU6IFwic3RhYmxlXCIsIC8vIGVpdGhlciBcImxhdGVzdFwiIG9yIFwic3RhYmxlXCIgKGRlZmF1bHQgXCJzdGFibGVcIilcclxuICAgICAgICAgICAgbWF4UmVzdWx0czogNSAvLyBkZWZhdWx0IDEwXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigocmVzdWx0OiBNTEtpdEltYWdlTGFiZWxpbmdDbG91ZFJlc3VsdCkgPT4gY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzdWx0LmxhYmVscykpKVxyXG4gICAgICAgIC5jYXRjaChlcnJvck1lc3NhZ2UgPT4gY29uc29sZS5sb2coXCJNTCBLaXQgZXJyb3I6IFwiICsgZXJyb3JNZXNzYWdlKSk7XHJcbiAgICB9XHJcbiAgICBsYW5kbWFya1JlY29nbml0aW9uKCl7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyOiBGb2xkZXIgPSA8Rm9sZGVyPiBrbm93bkZvbGRlcnMuY3VycmVudEFwcCgpO1xyXG4gICAgICAgIGNvbnN0IGZvbGRlclBhdGg6IHN0cmluZyA9IHBhdGguam9pbihmb2xkZXIucGF0aCwgXCIuL2ltYWdlcy82ODBweC1CcnVlZ2dlX1ZpZXdfZnJvbV9Sb3plbmhvZWRrYWFpLmpwZ1wiKTtcclxuICAgICAgICBjb25zdCBpbWFnZVNvdXJjZTogSW1hZ2VTb3VyY2UgPSA8SW1hZ2VTb3VyY2U+IGZyb21GaWxlKGZvbGRlclBhdGgpO1xyXG4gICAgICAgIGZpcmViYXNlLm1sa2l0LmxhbmRtYXJrcmVjb2duaXRpb24ucmVjb2duaXplTGFuZG1hcmtzQ2xvdWQoe1xyXG4gICAgICAgICAgICBpbWFnZTogaW1hZ2VTb3VyY2UsXHJcbiAgICAgICAgICAgIG1vZGVsVHlwZTogXCJsYXRlc3RcIiwgLy8gZWl0aGVyIFwibGF0ZXN0XCIgb3IgXCJzdGFibGVcIiAoZGVmYXVsdCBcInN0YWJsZVwiKVxyXG4gICAgICAgICAgICBtYXhSZXN1bHRzOiA4IC8vIGRlZmF1bHQgMTBcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKChyZXN1bHQ6IE1MS2l0TGFuZG1hcmtSZWNvZ25pdGlvbkNsb3VkUmVzdWx0KSA9PiBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXN1bHQubGFuZG1hcmtzKSkpXHJcbiAgICAgICAgLmNhdGNoKGVycm9yTWVzc2FnZSA9PiBjb25zb2xlLmxvZyhcIk1MIEtpdCBlcnJvcjogXCIgKyBlcnJvck1lc3NhZ2UpKTtcclxuICAgIH1cclxuICAgIGN1c3RvbU1vZGVsKCl7XHJcbiAgICAgICAgZmlyZWJhc2UubWxraXQuY3VzdG9tbW9kZWwudXNlQ3VzdG9tTW9kZWwoe1xyXG4gICAgICAgICAgICAgICAgLy8gaW1hZ2U6IGltYWdlU291cmNlLCAvLyBhIE5hdGl2ZVNjcmlwdCBJbWFnZSBvciBJbWFnZVNvdXJjZSwgc2VlIHRoZSBkZW1vIGZvciBleGFtcGxlc1xyXG4gICAgICAgICAgICAgICAgbWF4UmVzdWx0czogMTAsIC8vIGRlZmF1bHQgNSAobGltaXQgbnVtYmVycyB0byB0aGlzIGFtb3VudCBvZiByZXN1bHRzKVxyXG4gICAgICAgICAgICAgICAgbG9jYWxNb2RlbEZpbGU6IFwifi9jdXN0b21tb2RlbC9pbmNlcHRpb24vaW5jZXB0aW9uX3YzX3F1YW50LnRmbGl0ZVwiLCAvLyBzZWUgdGhlIGRlbW8sIHdoZXJlIHRoZSBtb2RlbCBsaXZlcyBpbiBhcHAvY3VzdG9tbW9kZWwvZXRjLi5cclxuICAgICAgICAgICAgICAgIGxhYmVsc0ZpbGU6IFwifi9jdXN0b21tb2RlbC9pbmNlcHRpb24vaW5jZXB0aW9uX2xhYmVscy50eHRcIixcclxuICAgICAgICAgICAgICAgIG1vZGVsSW5wdXQ6IFt7IC8vIEFycmF5PFROU0N1c3RvbU1vZGVsSW5wdXQ+XHJcbiAgICAgICAgICAgICAgICAgICAgc2hhcGU6IFsxLCAyOTksIDI5OSwgM10sIC8vIHNlZSB0aGUgdGlwcyBhYm92ZVxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiUVVBTlRcIiAvLyBmb3Igbm93LCBtdXN0IGJlIFwiUVVBTlRcIiAoYW5kIHlvdSBzaG91bGQgdXNlIGEgJ3F1YW50aXplZCcgbW9kZWwgKG5vdCAnZmxvYXQnKSlcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHQ6IE1MS2l0Q3VzdG9tTW9kZWxSZXN1bHQpID0+IGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3VsdC5yZXN1bHQpKSlcclxuICAgICAgICAgICAgLmNhdGNoKGVycm9yTWVzc2FnZSA9PiBjb25zb2xlLmxvZyhcIk1MIEtpdCBlcnJvcjogXCIgKyBlcnJvck1lc3NhZ2UpKTtcclxuICAgIH1cclxufVxyXG4iXX0=